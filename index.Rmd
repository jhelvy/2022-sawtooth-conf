---
title: "The cbcTools Package: Tools for Designing and Testing Choice-Based Conjoint Surveys in R"
author: "John Paul Helveston"
date: May 06, 2022
institute: "The George Washington University | Dept. of Engineering Management and Systems Engineering"
output:
  xaringan::moon_reader:
    css:
      - default
      - css/lexis.css
      - css/lexis-fonts.css
      - css/custom.css
    lib_dir: libs
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
      ratio: "16:9"
    seal: false
---

```{r setup, include=FALSE}
library(knitr)
library(fontawesome)
library(tidyverse)
library(metathis)
library(logitr)
library(cbcTools)

options(
  htmltools.dir.version = FALSE,
  knitr.table.format = "html",
  knitr.kable.NA = '',
  dplyr.width = Inf,
  width = 250
)

knitr::opts_chunk$set(
  cache = FALSE,
  warning = FALSE,
  message = FALSE,
  fig.path = "figs/",
  fig.width = 7.252,
  fig.height = 4,
  comment = "#>",
  fig.retina = 3
)

# Setup xaringanExtra options
xaringanExtra::use_xaringan_extra(c(
  "tile_view", "panelset", "share_again"))
xaringanExtra::style_share_again(share_buttons = "none")
xaringanExtra::use_extra_styles(
  hover_code_line = TRUE,
  mute_unhighlighted_code = FALSE
)

# Set up website metadata
meta() %>%
  meta_general(
    description = rmarkdown::metadata$subtitle,
    generator = "xaringan and remark.js"
  ) %>%
  meta_name("github-repo" = "jhelvy/2022-sawtooth-conf") %>%
  meta_social(
    title = rmarkdown::metadata$title,
    url = "https://jhelvy.com",
    og_type = "website",
    og_author = "John Paul Helveston",
    twitter_card_type = "summary_large_image",
    twitter_creator = "@johnhelveston"
  )

knitr::opts_chunk$set(
    warning = FALSE,
    message = FALSE,
    comment = "#>",
    fig.path = "figs/",
    fig.retina = 3 # Better figure resolution
)
```

layout: true

<!-- this adds the link footer to all slides, depends on my-footer class in css-->

<div class="footer-small">
<span>
https://github.com/jhelvy/2022-sawtooth-conf
</span>
</div>

---

name: title-slide
class: inverse, middle
background-image: url(images/blue.jpg)

# The `cbcTools` Package <a href='https://jhelvy.github.io/cbcTools/'><img src='images/logo.png' align="right" height="300"/></a>

## Tools for Designing and Testing<br>Choice-Based Conjoint Surveys in `r fa("r-project", fill = "white")`

### by John Paul Helveston

Sawtooth Software Conference

May 06, 2022

---

class: center

### Designing a Choice-Based Conjoint Survey is Hard

--

<center>
<img src="images/tradeoffs1.png" width=90%>
</center>

---

class: center

### Designing a Choice-Based Conjoint Survey is Hard

<center>
<img src="images/tradeoffs2.png" width=90%>
</center>

---

class: center

### Designing a Choice-Based Conjoint Survey is Hard

<center>
<img src="images/tradeoffs3.png" width=90%>
</center>

---

# .center[A simple conjoint experiment about _cars_]

Attribute | Levels
----------|----------
Brand     | GW, BMW, Ferrari 
Price     | $20k, $40k, $100k

.center[**Design: .red[9] choice sets, .blue[3] alternatives each**]

--

.leftcol[

```
Attribute counts:

brand:
  GM   BMW  Ferrari 
  10    11    6 

price:

 20k  40k 100k 
  9    9   9
```

]

--

.rightcol[

```
Pairwise attribute counts:

brand & price:
         
          20k 40k 100k
  GM        3   0    7
  BMW       4   5    2
  Ferrari   2   4    0
```

]

---

# .center[A simple conjoint experiment about _cars_]

Attribute | Levels
----------|----------
Brand     | GW, BMW, Ferrari 
Price     | $20k, $40k, $100k

.center[**Design: .red[900] choice sets, .blue[3] alternatives each**]

--

.leftcol[

```
Attribute counts:

brand:
  GM    BMW   Ferrari 
  925   910     865 

price:

  20k  40k 100k 
  889  913  898 
```

]

--

.rightcol[

```
Pairwise attribute counts:

brand & price:
         
          20k 40k 100k
  GM      308 317  300
  BMW     311 306  293
  Ferrari 270 290  305
```

]

---

D-efficient design with priors 

In this case we might not want perfect balance because there are certain combinations that shouldn't show up as often.

---

# .center[But what about other factors?]

<br>

- What if I add one more choice question to each respondent?

--

- What if I increase the number of alternatives per choice question?

--

- What if I use a labeled design?

--

- What if there are interaction effects?

---

We can use {cbcTools} to address these questions **before** fielding our survey

(show image comparing different power curves for different designs)

left(no int) right(int)

---

class: middle, center, inverse 

The {cbcTools} package

---

Basics 

All functions start with `cbc_`

[screenshot of helper pop up]

---

Workflow:

- Set levels 
- Make profiles 
- Make design 
- Inspect design
- Simulate choices
- Assess power

---

Full workflow example: apples

---

Comparison examples

Labeled vs. unlabeled

---

Iteractions vs. no interactions

# .center[Example: Wine Pairings]

.leftcol40[

meat | wine
-----|------
fish | white
fish | red
steak | white
steak | red

]

--

.rightcol60[

## Main Effects

1. **Fish** or **Steak**?
2. **Red** or **White** wine?

## Interaction Effects

1. **Red** or **White** wine _with **Steak**_?
2. **Red** or **White** wine _with **Fish**_?
]


---

class: inverse
background-image: url(images/blue.jpg)

<br>

# .center[.font150[Thanks!]]

### `cbcTools` documentation: https://jhelvy.github.io/cbcTools/

### Slides: https://jhelvy.github.io/2022-sawtooth-conf

.footer-large[
.right[
@johnhelveston `r fa(name = "twitter", fill = "white")`<br>
@jhelvy `r fa(name = "github", fill = "white")`<br>
@jhelvy `r fa(name = "weixin", fill = "white")`<br>
jhelvy.com `r fa(name = "link", fill = "white")`<br>
jph@gwu.edu `r fa(name = "paper-plane", fill = "white")`
]]

---

class: center, middle, inverse 

# Extra slides







Orthogonality

    Each attribute level appears an equal number of times in combination with all other attribute levels.

Balance

    Each level within an attribute to appear an equal number of times.

Overlap

    When a set of alternatives has the same level for a given attribute (simplifies decision process for respondents).
    Overlap thus can improve response efficiency but also reduce design efficiency.
